<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>My Files - Dashboard</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
        <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
        <link rel="stylesheet" th:href="@{/css/input.css}">
        <style>
            .file-card {
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            }

            .file-card:hover {
                transform: translateY(-4px);
            }

            .gradient-bg {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            }

            .stat-card {
                backdrop-filter: blur(10px);
            }

            .tab-active {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
            }

            .search-input:focus {
                box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.3);
            }

            .file-icon-wrapper {
                background: linear-gradient(135deg, #f0f4ff 0%, #e8ecff 100%);
            }

            .action-btn {
                transition: all 0.2s ease;
            }

            .action-btn:hover {
                transform: scale(1.05);
            }
        </style>
    </head>

    <body class="bg-gray-100 min-h-screen">

        <!-- Navbar -->
        <th:block th:replace="~{Fragments/header :: nav-1}"></th:block>

        <!-- Main Content -->
        <div class="pt-20 pb-12">
            <!-- Header Section with Gradient -->
            <div class="gradient-bg py-8 mb-8">
                <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="flex flex-col md:flex-row md:items-center md:justify-between">
                        <div>
                            <h1 class="text-3xl font-bold text-white flex items-center gap-3">
                                <i class='bx bx-folder-open text-4xl'></i>
                                My Files
                            </h1>
                            <p class="mt-2 text-indigo-100">Manage and share your files securely</p>
                        </div>
                        <div class="mt-4 md:mt-0">
                            <a href="/files/dashboard"
                                class="inline-flex items-center px-5 py-2.5 bg-white text-indigo-600 font-semibold rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 hover:scale-105"></a>
                            <i class='bx bx-cloud-upload text-xl mr-2'></i>
                            Upload New File
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <!-- Stats Cards -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div
                        class="stat-card bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-500">Total Uploaded</p>
                                <p class="text-3xl font-bold text-gray-900 mt-1" th:text="${#lists.size(uploadedFiles)}">0</p>
                    </div>
                    <div class="w-14 h-14 bg-indigo-100 rounded-2xl flex items-center justify-center">
                        <i class='bx bx-upload text-2xl text-indigo-600'></i>
                    </div>
                </div>
                <div class="mt-4 flex items-center text-sm text-green-600">
                    <i class='bx bx-trending-up mr-1'></i>
                    <span>Your files</span>
                </div>
            </div>

            <div class="stat-card bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-500">Shared with Me</p>
                        <p class="text-3xl font-bold text-gray-900 mt-1" th:text="${#lists.size(receivedFiles)}">0</p>
                    </div>
                    <div class="w-14 h-14 bg-green-100 rounded-2xl flex items-center justify-center">
                        <i class='bx bx-share-alt text-2xl text-green-600'></i>
                    </div>
                </div>
                <div class="mt-4 flex items-center text-sm text-blue-600">
                    <i class='bx bx-group mr-1'></i>
                    <span>From others</span>
                </div>
            </div>

            <div class="stat-card bg-white rounded-2xl p-6 shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-500">Total Files</p>
                        <p class="text-3xl font-bold text-gray-900 mt-1" 
                           th:text="${#lists.size(uploadedFiles) + #lists.size(receivedFiles)}">0</p>
                    </div>
                    <div class="w-14 h-14 bg-purple-100 rounded-2xl flex items-center justify-center">
                        <i class='bx bx-folder text-2xl text-purple-600'></i>
                    </div>
                </div>
                <div class="mt-4 flex items-center text-sm text-purple-600">
                    <i class='bx bx-check-circle mr-1'></i>
                    <span>All accessible</span>
                </div>
            </div>
        </div>

        <!-- Search and Filter Bar -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-4 mb-8">
            <div class="flex flex-col md:flex-row md:items-center gap-4">
                <!-- Search -->
                <div class="flex-1 relative">
                    <i class='bx bx-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 text-xl'></i>
                    <input type="text" id="searchInput" placeholder="Search files..." 
                           class="search-input w-full pl-12 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:outline-none focus:border-indigo-500 transition-all">
                </div>
                
                <!-- View Toggle -->
                <div class="flex items-center gap-2 bg-gray-100 p-1 rounded-xl"></div>
                    <button id="gridView" class="p-2.5 rounded-lg bg-white shadow-sm text-indigo-600" title="Grid View">
                        <i class='bx bx-grid-alt text-xl'></i>
                    </button>
                    <button id="listView" class="p-2.5 rounded-lg text-gray-500 hover:text-indigo-600 transition-colors" title="List View">
                        <i class='bx bx-list-ul text-xl'></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="flex flex-wrap gap-2 mb-8" id="file-tabs">
            <button data-tab="uploaded" 
                    class="tab-btn tab-active px-6 py-3 rounded-xl font-medium transition-all duration-300 flex items-center gap-2">
                <i class='bx bx-upload'></i>
                Uploaded Files
                <span class="bg-white/20 px-2 py-0.5 rounded-full text-sm" th:text="${#lists.size(uploadedFiles)}">0</span>
            </button>
            <button data-tab="shared" 
                    class="tab-btn px-6 py-3 rounded-xl font-medium bg-white text-gray-600 hover:bg-gray-50 transition-all duration-300 flex items-center gap-2 shadow-sm">
                <i class='bx bx-share-alt'></i>
                Shared with Me
                <span class="bg-gray-100 px-2 py-0.5 rounded-full text-sm" th:text="${#lists.size(receivedFiles)}">0</span>
            </button>
        </div>

        <!-- Uploaded Files Section -->
        <section id="uploaded" class="tab-content">
            <!-- Grid View -->
            <div id="uploadedGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <div th:each="file : ${uploadedFiles}" 
                     class="file-card file-item bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-xl"
                     th:data-filename="${file.fileName}">
                    <!-- File Preview Area -->
                    <div class="file-icon-wrapper h-36 flex items-center justify-center relative group">
                        <!-- Document icon -->
                        <i th:if="${#strings.startsWith(file.fileType, 'text') or #strings.contains(file.fileType, 'document') or #strings.contains(file.fileType, 'word')}"
                           class='bx bxs-file-doc text-6xl text-indigo-500'></i>
                        <!-- PDF icon -->
                        <i th:if="${#strings.contains(file.fileType, 'pdf')}"
                           class='bx bxs-file-pdf text-6xl text-red-500'></i>
                        <!-- Image icon -->
                        <i th:if="${#strings.startsWith(file.fileType, 'image')}"
                           class='bx bxs-image text-6xl text-pink-500'></i>
                        <!-- Video icon -->
                        <i th:if="${#strings.startsWith(file.fileType, 'video')}"
                           class='bx bxs-video text-6xl text-purple-500'></i>
                        <!-- Audio icon -->
                        <i th:if="${#strings.startsWith(file.fileType, 'audio')}"
                           class='bx bxs-music text-6xl text-green-500'></i>
                        <!-- Excel icon -->
                        <i th:if="${#strings.contains(file.fileType, 'spreadsheet') or #strings.contains(file.fileType, 'excel')}"
                           class='bx bxs-spreadsheet text-6xl text-green-600'></i>
                        <!-- Default file icon -->
                        <i th:unless="${#strings.startsWith(file.fileType, 'text') or #strings.contains(file.fileType, 'document') or #strings.contains(file.fileType, 'word') or #strings.contains(file.fileType, 'pdf') or #strings.startsWith(file.fileType, 'image') or #strings.startsWith(file.fileType, 'video') or #strings.startsWith(file.fileType, 'audio') or #strings.contains(file.fileType, 'spreadsheet') or #strings.contains(file.fileType, 'excel')}"
                           class='bx bxs-file text-6xl text-gray-400'></i>
                        
                        <!-- Hover Overlay -->
                        <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-3">
                            <a th:href="@{/files/download/{id}(id=${file.id})}"
                               class="action-btn w-10 h-10 bg-white rounded-full flex items-center justify-center text-indigo-600 hover:bg-indigo-600 hover:text-white">
                                <i class='bx bx-download text-xl'></i>
                            </a>
                            <a th:href="@{/files/send/{id}(id=${file.id})}"
                               class="action-btn w-10 h-10 bg-white rounded-full flex items-center justify-center text-green-600 hover:bg-green-600 hover:text-white">
                                <i class='bx bx-share-alt text-xl'></i>
                            </a>
                        </div>
                    </div>
                    
                    <!-- File Info -->
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-900 truncate mb-2" th:text="${file.fileName}" th:title="${file.fileName}"></h3>
                        <div class="flex items-center justify-between text-sm">
                            <span class="px-2.5 py-1 bg-indigo-50 text-indigo-600 rounded-lg font-medium"
                                  th:text="${#numbers.formatDecimal(file.fileSize / 1024.0, 1, 2)} + ' KB'"></span>
                            <span class="text-gray-400 truncate ml-2" th:text="${file.fileType}" th:title="${file.fileType}"></span>
                        </div>
                        
                        <!-- Action Buttons (Mobile) -->
                        <div class="mt-4 flex gap-2 md:hidden">
                            <a th:href="@{/files/download/{id}(id=${file.id})}"
                               class="flex-1 text-center py-2 bg-indigo-50 text-indigo-600 rounded-lg font-medium text-sm hover:bg-indigo-100 transition-colors">
                                <i class='bx bx-download mr-1'></i> Download
                            </a>
                            <a th:href="@{/files/send/{id}(id=${file.id})}"
                               class="flex-1 text-center py-2 bg-green-50 text-green-600 rounded-lg font-medium text-sm hover:bg-green-100 transition-colors">
                                <i class='bx bx-share-alt mr-1'></i> Share
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- List View (Hidden by default) -->
            <div id="uploadedList" class="hidden bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                <table class="w-full">
                    <thead class="bg-gray-50 border-b border-gray-100">
                        <tr>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">File Name</th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider hidden md:table-cell">Type</th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Size</th>
                            <th class="px-6 py-4 text-right text-xs font-semibold text-gray-500 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-100">
                        <tr th:each="file : ${uploadedFiles}" class="file-item hover:bg-gray-50 transition-colors" th:data-filename="${file.fileName}">
                            <td class="px-6 py-4">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 bg-indigo-50 rounded-xl flex items-center justify-center mr-3">
                                        <i th:if="${#strings.startsWith(file.fileType, 'image')}" class='bx bxs-image text-pink-500'></i>
                                        <i th:if="${#strings.contains(file.fileType, 'pdf')}" class='bx bxs-file-pdf text-red-500'></i>
                                        <i th:unless="${#strings.startsWith(file.fileType, 'image') or #strings.contains(file.fileType, 'pdf')}" class='bx bxs-file text-indigo-500'></i>
                                    </div>
                                    <span class="font-medium text-gray-900 truncate max-w-xs" th:text="${file.fileName}"></span>
                                </div>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-500 hidden md:table-cell" th:text="${file.fileType}"></td>
                            <td class="px-6 py-4">
                                <span class="px-2.5 py-1 bg-indigo-50 text-indigo-600 rounded-lg text-sm font-medium"
                                      th:text="${#numbers.formatDecimal(file.fileSize / 1024.0, 1, 2)} + ' KB'"></span>
                            </td>
                            <td class="px-6 py-4 text-right">
                                <div class="flex items-center justify-end gap-2">
                                    <a th:href="@{/files/download/{id}(id=${file.id})}"
                                       class="p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors" title="Download">
                                        <i class='bx bx-download text-xl'></i>
                                    </a>
                                    <a th:href="@{/files/send/{id}(id=${file.id})}"
                                       class="p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors" title="Share">
                                        <i class='bx bx-share-alt text-xl'></i>
                                    </a>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Empty State -->
            <div th:if="${#lists.isEmpty(uploadedFiles)}" class="bg-white rounded-2xl shadow-sm border border-gray-100 py-16 flex flex-col items-center justify-center">
                <div class="w-24 h-24 bg-indigo-50 rounded-full flex items-center justify-center mb-6">
                    <i class='bx bx-cloud-upload text-5xl text-indigo-400'></i>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">No uploaded files yet</h3>
                <p class="text-gray-500 mb-6">Get started by uploading your first file</p>
                <a href="/files/dashboard" 
                   class="inline-flex items-center px-6 py-3 bg-indigo-600 text-white font-semibold rounded-xl hover:bg-indigo-700 transition-colors shadow-lg hover:shadow-xl">
                    <i class='bx bx-upload mr-2 text-xl'></i> Upload a File
                </a>
            </div>
        </section>
</div>div>i></i>""

        <!-- Shared Files Section -->
        <section id="shared" class="tab-content hidden">
            <!-- Grid View -->
            <div id="sharedGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <div th:each="file : ${receivedFiles}" 
                     class="file-card file-item bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-xl"
                     th:data-filename="${file.fileName}">
                    <!-- File Preview Area -->
                    <div class="file-icon-wrapper h-36 flex items-center justify-center relative group">
                        <!-- Document icon -->
                        <i th:if="${#strings.startsWith(file.fileType, 'text') or #strings.contains(file.fileType, 'document') or #strings.contains(file.fileType, 'word')}"
                           class='bx bxs-file-doc text-6xl text-indigo-500'></i>
                        <!-- PDF icon -->
                        <i th:if="${#strings.contains(file.fileType, 'pdf')}"
                           class='bx bxs-file-pdf text-6xl text-red-500'></i>
                        <!-- Image icon -->
                        <i th:if="${#strings.startsWith(file.fileType, 'image')}"
                           class='bx bxs-image text-6xl text-pink-500'></i>
                        <!-- Video icon -->
                        <i th:if="${#strings.startsWith(file.fileType, 'video')}"
                           class='bx bxs-video text-6xl text-purple-500'></i>
                        <!-- Audio icon -->
                        <i th:if="${#strings.startsWith(file.fileType, 'audio')}"
                           class='bx bxs-music text-6xl text-green-500'></i>
                        <!-- Excel icon -->
                        <i th:if="${#strings.contains(file.fileType, 'spreadsheet') or #strings.contains(file.fileType, 'excel')}"
                           class='bx bxs-spreadsheet text-6xl text-green-600'></i>
                        <!-- Default file icon -->
                        <i th:unless="${#strings.startsWith(file.fileType, 'text') or #strings.contains(file.fileType, 'document') or #strings.contains(file.fileType, 'word') or #strings.contains(file.fileType, 'pdf') or #strings.startsWith(file.fileType, 'image') or #strings.startsWith(file.fileType, 'video') or #strings.startsWith(file.fileType, 'audio') or #strings.contains(file.fileType, 'spreadsheet') or #strings.contains(file.fileType, 'excel')}"
                           class='bx bxs-file text-6xl text-gray-400'></i>
                        
                        <!-- Shared Badge -->
                        <div class="absolute top-3 left-3">
                            <span class="px-2 py-1 bg-green-500 text-white text-xs font-medium rounded-full flex items-center gap-1">
                                <i class='bx bx-share-alt'></i> Shared
                            </span>
                        </div>
                        
                        <!-- Hover Overlay -->
                        <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                            <a th:href="@{/files/download/{id}(id=${file.id})}"
                               class="action-btn w-12 h-12 bg-white rounded-full flex items-center justify-center text-indigo-600 hover:bg-indigo-600 hover:text-white">
                                <i class='bx bx-download text-2xl'></i>
                            </a>
                        </div>
                    </div>
                    
                    <!-- File Info -->
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-900 truncate mb-2" th:text="${file.fileName}" th:title="${file.fileName}"></h3>
                        <div class="flex items-center justify-between text-sm mb-3">
                            <span class="px-2.5 py-1 bg-indigo-50 text-indigo-600 rounded-lg font-medium"
                                  th:text="${#numbers.formatDecimal(file.fileSize / 1024.0, 1, 2)} + ' KB'"></span>
                            <span class="text-gray-400 truncate ml-2" th:text="${file.fileType}" th:title="${file.fileType}"></span>
                        </div>
                        
                        <!-- Shared By -->
                        <div class="flex items-center pt-3 border-t border-gray-100">
                            <div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-full flex items-center justify-center text-white text-sm font-medium"
                                 th:text="${#strings.substring(file.uploader.username, 0, 1).toUpperCase()}">U</div>
                            <div class="ml-2">
                                <p class="text-xs text-gray-400">Shared by</p>
                                <p class="text-sm font-medium text-gray-700" th:text="${file.uploader.username}"></p>
                            </div>
                        </div>
                        
                        <!-- Action Button (Mobile) -->
                        <div class="mt-4 md:hidden">
                            <a th:href="@{/files/download/{id}(id=${file.id})}"
                               class="block text-center py-2 bg-indigo-50 text-indigo-600 rounded-lg font-medium text-sm hover:bg-indigo-100 transition-colors">
                                <i class='bx bx-download mr-1'></i> Download
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- List View (Hidden by default) -->
            <div id="sharedList" class="hidden bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden">
                <table class="w-full">
                    <thead class="bg-gray-50 border-b border-gray-100">
                        <tr>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">File Name</th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider hidden md:table-cell">Type</th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">Size</th>
                            <th class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider hidden lg:table-cell">Shared By</th>
                            <th class="px-6 py-4 text-right text-xs font-semibold text-gray-500 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-100">
                        <tr th:each="file : ${receivedFiles}" class="file-item hover:bg-gray-50 transition-colors" th:data-filename="${file.fileName}">
                            <td class="px-6 py-4">
                                <div class="flex items-center">
                                    <div class="w-10 h-10 bg-indigo-50 rounded-xl flex items-center justify-center mr-3">
                                        <i th:if="${#strings.startsWith(file.fileType, 'image')}" class='bx bxs-image text-pink-500'></i>
                                        <i th:if="${#strings.contains(file.fileType, 'pdf')}" class='bx bxs-file-pdf text-red-500'></i>
                                        <i th:unless="${#strings.startsWith(file.fileType, 'image') or #strings.contains(file.fileType, 'pdf')}" class='bx bxs-file text-indigo-500'></i>
                                    </div>
                                    <span class="font-medium text-gray-900 truncate max-w-xs" th:text="${file.fileName}"></span>
                                </div>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-500 hidden md:table-cell" th:text="${file.fileType}"></td>
                            <td class="px-6 py-4">
                                <span class="px-2.5 py-1 bg-indigo-50 text-indigo-600 rounded-lg text-sm font-medium"
                                      th:text="${#numbers.formatDecimal(file.fileSize / 1024.0, 1, 2)} + ' KB'"></span>
                            </td>
                            <td class="px-6 py-4 hidden lg:table-cell">
                                <div class="flex items-center">
                                    <div class="w-8 h-8 bg-gradient-to-br from-indigo-500 to-purple-500 rounded-full flex items-center justify-center text-white text-xs font-medium"
                                         th:text="${#strings.substring(file.uploader.username, 0, 1).toUpperCase()}">U</div>
                                    <span class="ml-2 text-sm text-gray-700" th:text="${file.uploader.username}"></span>
                                </div>
                            </td>
                            <td class="px-6 py-4 text-right">
                                <a th:href="@{/files/download/{id}(id=${file.id})}"
                                   class="p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors inline-flex" title="Download">
                                    <i class='bx bx-download text-xl'></i>
                                </a>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Empty State -->
            <div th:if="${#lists.isEmpty(receivedFiles)}" class="bg-white rounded-2xl shadow-sm border border-gray-100 py-16 flex flex-col items-center justify-center">
                <div class="w-24 h-24 bg-green-50 rounded-full flex items-center justify-center mb-6">
                    <i class='bx bx-share-alt text-5xl text-green-400'></i>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">No shared files yet</h3>
                <p class="text-gray-500">Files shared with you will appear here</p>
            </div>
        </section>
    </main>
</div>

<script th:src="@{/js/script.js}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Tab Switching
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');

        tabBtns.forEach(btn => {
            btn.addEventListener('click', function () {
                const targetTab = this.dataset.tab;

                // Update tab buttons
                tabBtns.forEach(b => {
                    b.classList.remove('tab-active');
                    b.classList.add('bg-white', 'text-gray-600', 'shadow-sm');
                });
                this.classList.add('tab-active');
                this.classList.remove('bg-white', 'text-gray-600', 'shadow-sm');

                // Update tab contents
                tabContents.forEach(content => {
                    content.classList.add('hidden');
                    if (content.id === targetTab) {
                        content.classList.remove('hidden');
                    }
                });
            });
        });

        // View Toggle
        const gridViewBtn = document.getElementById('gridView');
        const listViewBtn = document.getElementById('listView');
        const uploadedGrid = document.getElementById('uploadedGrid');
        const uploadedList = document.getElementById('uploadedList');
        const sharedGrid = document.getElementById('sharedGrid');
        const sharedList = document.getElementById('sharedList');

        gridViewBtn.addEventListener('click', function () {
            this.classList.add('bg-white', 'shadow-sm', 'text-indigo-600');
            this.classList.remove('text-gray-500');
            listViewBtn.classList.remove('bg-white', 'shadow-sm', 'text-indigo-600');
            listViewBtn.classList.add('text-gray-500');

            uploadedGrid?.classList.remove('hidden');
            uploadedList?.classList.add('hidden');
            sharedGrid?.classList.remove('hidden');
            sharedList?.classList.add('hidden');
        });

        listViewBtn.addEventListener('click', function () {
            this.classList.add('bg-white', 'shadow-sm', 'text-indigo-600');
            this.classList.remove('text-gray-500');
            gridViewBtn.classList.remove('bg-white', 'shadow-sm', 'text-indigo-600');
            gridViewBtn.classList.add('text-gray-500');

            uploadedGrid?.classList.add('hidden');
            uploadedList?.classList.remove('hidden');
            sharedGrid?.classList.add('hidden');
            sharedList?.classList.remove('hidden');
        });

        // Search Functionality
        const searchInput = document.getElementById('searchInput');
        searchInput.addEventListener('input', function () {
            const searchTerm = this.value.toLowerCase();
            const fileItems = document.querySelectorAll('.file-item');

            fileItems.forEach(item => {
                const fileName = item.dataset.filename?.toLowerCase() || '';
                if (fileName.includes(searchTerm)) {
                    item.style.display = '';
                } else {
                    item.style.display = 'none';
                }
            });
        });
    });
</script>

</body>
</html>